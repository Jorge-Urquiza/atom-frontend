import{a as pe}from"./chunk-F3DIJNIY.js";import{A as j,Aa as ve,B as w,Ba as ke,C as Y,Ca as Te,D as s,Da as be,E,Ea as Ce,F as Z,G as ee,I as te,J as ie,K as re,N as L,O as ne,P as oe,Q as ae,ca as se,d as W,da as z,e as I,ea as le,f as X,fa as M,ga as k,h as g,ha as B,i as F,ia as N,j as y,ja as V,k as _,ka as q,la as R,m as c,ma as G,n as l,na as me,oa as ce,pa as $,qa as T,r as h,ra as de,s as p,sa as v,t as o,ta as b,u as n,ua as ue,v as m,va as fe,w as Q,wa as ge,x as d,xa as A,y as x,ya as U,z as D,za as he}from"./chunk-QOS3VMFK.js";var S=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${pe.apiBaseUrl}/tasks`}getUserTasks(){return this.http.get(this.apiUrl)}createTask(e){return this.http.post(this.apiUrl,e)}updateTask(e,i){return this.http.put(`${this.apiUrl}/${e}`,i)}deleteTask(e){return this.http.delete(`${this.apiUrl}/${e}`)}static{this.\u0275fac=function(i){return new(i||r)(X(ae))}}static{this.\u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function De(r,f){r&1&&(o(0,"small",10),s(1," El campo t\xEDtulo es requerido "),n())}function je(r,f){r&1&&(o(0,"small",10),s(1," El campo descripci\xF3n es requerido "),n())}var _e=(()=>{class r{constructor(e,i,t,a){this.formBuilder=e,this.ref=i,this.taskService=t,this.messageService=a,this.loading=!1}ngOnInit(){this.createFormTask=this.formBuilder.group({title:["",k.required],description:["",k.required]})}get title(){return this.createFormTask.get("title")}get description(){return this.createFormTask.get("description")}onSubmit(){if(this.createFormTask.invalid){this.createFormTask.markAllAsTouched();return}let e=this.createFormTask.value;this.loading=!0,this.taskService.createTask(e).subscribe({next:()=>{this.loading=!1,this.messageService.add({severity:"success",summary:"Tarea creada",detail:`La tarea "${e.title}" fue creada exitosamente.`}),this.ref.close(!0)},error:()=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error al crear la tarea"})}})}onCancel(){this.ref.close(!1)}static{this.\u0275fac=function(i){return new(i||r)(l(G),l(A),l(S),l(T))}}static{this.\u0275cmp=g({type:r,selectors:[["app-task-create"]],decls:14,vars:5,consts:[[1,"p-fluid",3,"ngSubmit","formGroup"],[1,"field"],["for","title"],["id","title","type","text","pInputText","","formControlName","title"],["class","p-error",4,"ngIf"],["for","description"],["id","title","type","text","pInputText","","formControlName","description"],[1,"flex","justify-content-end","gap-2","mt-4"],["pButton","","type","button","label","Cancelar",1,"p-button-text",3,"click"],["pButton","","type","submit","label","Guardar",3,"disabled","loading"],[1,"p-error"]],template:function(i,t){i&1&&(o(0,"form",0),d("ngSubmit",function(){return t.onSubmit()}),o(1,"div",1)(2,"label",2),s(3,"T\xEDtulo*"),n(),m(4,"input",3),h(5,De,2,0,"small",4),n(),o(6,"div",1)(7,"label",5),s(8,"Descripci\xF3n*"),n(),m(9,"input",6),h(10,je,2,0,"small",4),n(),o(11,"div",7)(12,"button",8),d("click",function(){return t.onCancel()}),n(),m(13,"button",9),n()()),i&2&&(p("formGroup",t.createFormTask),c(5),p("ngIf",(t.title==null?null:t.title.invalid)&&(t.title==null?null:t.title.touched)),c(5),p("ngIf",(t.description==null?null:t.description.invalid)&&(t.description==null?null:t.description.touched)),c(3),p("disabled",t.createFormTask.invalid||t.loading)("loading",t.loading))},dependencies:[L,V,M,B,N,q,R,v,b]})}}return r})();function we(r,f){r&1&&(o(0,"small",10),s(1," El campo t\xEDtulo es requerido "),n())}function Le(r,f){r&1&&(o(0,"small",10),s(1," El campo descripci\xF3n es requerido "),n())}var xe=(()=>{class r{constructor(e,i,t,a,u){this.formBuilder=e,this.taskService=i,this.messageService=t,this.ref=a,this.config=u,this.loading=!1}ngOnInit(){let e=this.config.data?.task;if(!e){this.ref.close();return}this.taskId=e.id,this.editFormTask=this.formBuilder.group({title:[e.title,k.required],description:[e.description,k.required]})}get title(){return this.editFormTask.get("title")}get description(){return this.editFormTask.get("description")}onSubmit(){if(this.editFormTask.invalid){this.editFormTask.markAllAsTouched();return}let e=this.editFormTask.value;this.loading=!0,this.taskService.updateTask(this.taskId,e).subscribe({next:()=>{this.loading=!1,this.messageService.add({severity:"success",summary:"Tarea actualizada",detail:`La tarea "${e.title}" se actualizo correctamente.`}),this.ref.close(!0)},error:()=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error al actualizar"})}})}onCancel(){this.ref.close(!1)}static{this.\u0275fac=function(i){return new(i||r)(l(G),l(S),l(T),l(A),l(ge))}}static{this.\u0275cmp=g({type:r,selectors:[["app-task-edit"]],decls:14,vars:5,consts:[[1,"p-fluid",3,"ngSubmit","formGroup"],[1,"field"],["for","title"],["id","title","type","text","pInputText","","formControlName","title"],["class","p-error",4,"ngIf"],["for","description"],["id","title","type","text","pInputText","","formControlName","description"],[1,"flex","justify-content-end","gap-2","mt-4"],["pButton","","type","button","label","Cancelar",1,"p-button-text",3,"click"],["pButton","","type","submit","label","Guardar",3,"disabled","loading"],[1,"p-error"]],template:function(i,t){i&1&&(o(0,"form",0),d("ngSubmit",function(){return t.onSubmit()}),o(1,"div",1)(2,"label",2),s(3,"T\xEDtulo"),n(),m(4,"input",3),h(5,we,2,0,"small",4),n(),o(6,"div",1)(7,"label",5),s(8,"Descripci\xF3n*"),n(),m(9,"input",6),h(10,Le,2,0,"small",4),n(),o(11,"div",7)(12,"button",8),d("click",function(){return t.onCancel()}),n(),m(13,"button",9),n()()),i&2&&(p("formGroup",t.editFormTask),c(5),p("ngIf",(t.title==null?null:t.title.invalid)&&(t.title==null?null:t.title.touched)),c(5),p("ngIf",(t.description==null?null:t.description.invalid)&&(t.description==null?null:t.description.touched)),c(3),p("disabled",t.editFormTask.invalid||t.loading)("loading",t.loading))},dependencies:[L,V,M,B,N,q,R,v,b]})}}return r})();var Me=["table"],Be=()=>["title","description"];function Ne(r,f){if(r&1){let e=Q();o(0,"div",5)(1,"h2",6),s(2,"Mis tareas"),n(),o(3,"span",7),m(4,"i",8),o(5,"input",9),d("input",function(t){y(e);let a=x(),u=Y(1);return _(a.onGlobalFilter(u,t))}),n()()()}}function Ve(r,f){r&1&&(o(0,"tr")(1,"th"),s(2,"#"),n(),o(3,"th",10),s(4,"Titulo "),m(5,"p-sortIcon",11),n(),o(6,"th",12),s(7,"Descripci\xF3n "),m(8,"p-sortIcon",13),n(),o(9,"th",14),s(10,"Estado"),n(),o(11,"th",15),s(12,"Fecha creaci\xF3n "),m(13,"p-sortIcon",16),n(),o(14,"th"),s(15,"Acciones"),n()())}function qe(r,f){if(r&1){let e=Q();o(0,"tr")(1,"td"),s(2),n(),o(3,"td"),s(4),n(),o(5,"td"),s(6),n(),o(7,"td")(8,"div",17)(9,"input",18),d("click",function(t){let a=y(e).$implicit,u=x();return _(u.confirmStatusChange(t,a))}),n(),m(10,"p-tag",19),n()(),o(11,"td"),s(12),te(13,"date"),n(),o(14,"td")(15,"button",20),d("click",function(){let t=y(e).$implicit,a=x();return _(a.editTask(t))}),n(),o(16,"button",21),d("click",function(t){let a=y(e).$implicit,u=x();return _(u.confirmDelete(t,a))}),n()()()}if(r&2){let e=f.$implicit,i=f.rowIndex;c(2),E(i+1),c(2),E(e.title),c(2),E(e.description),c(3),p("checked",e.completed),c(),p("value","Pendiente")("severity","danger"),c(2),E(ie(13,7,e.createdAt,"dd/MM/yyyy"))}}var P=(()=>{class r{constructor(e,i,t,a,u){this.taskService=e,this.messageService=i,this.dialogService=t,this.cdr=a,this.confirmationService=u,this.tasks=[]}ngOnInit(){this.loadTasks()}loadTasks(){this.taskService.getUserTasks().subscribe({next:e=>{this.tasks=e.data},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las tareas."})}})}onGlobalFilter(e,i){e.filterGlobal(i.target.value,"contains")}editTask(e){this.dialogService.open(xe,{header:"Editar tarea",modal:!0,width:"500px",data:{task:e}}).onClose.subscribe(t=>{t&&this.loadTasks()})}confirmDelete(e,i){this.confirmationService.confirm({key:"confirmationDialog",target:e.target,message:"\xBFEst\xE1s seguro(a) de que quieres eliminar esta tarea?",header:"Confirmaci\xF3n",icon:"pi pi-exclamation-triangle",acceptLabel:"Si",rejectLabel:"No",acceptButtonStyleClass:"p-button-sucess p-button-text",rejectButtonStyleClass:"p-button-danger p-button-text",acceptIcon:"pi pi-check mr-2",rejectIcon:"pi pi-times mr-2",defaultFocus:"none",accept:()=>{this.delete(i)},reject:()=>{}})}confirmStatusChange(e,i){e.preventDefault();let t=!i.completed;this.confirmationService.confirm({key:"confirmationDialog",header:"Confirmar cambio de estado",message:"\xBFDeseas marcar esta tarea como 'completada'?",icon:"pi pi-exclamation-triangle",acceptLabel:"Si",rejectLabel:"No",acceptButtonStyleClass:"p-button-sucess p-button-text",rejectButtonStyleClass:"p-button-danger p-button-text",acceptIcon:"pi pi-check mr-2",rejectIcon:"pi pi-times mr-2",defaultFocus:"none",accept:()=>{this.taskService.updateTask(i.id,{completed:t}).subscribe({next:()=>{i.completed=t,this.loadTasks(),this.messageService.add({severity:"success",summary:"Tarea actualizada",detail:"Estado: 'Completada' "})},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"No se pudo actualizar el estado de la tarea."})}})}})}delete(e){e.id&&this.taskService.deleteTask(e.id).subscribe({next:()=>{this.loadTasks(),this.messageService.add({severity:"success",summary:"Tarea eliminada",detail:`La tarea "${e.title}" fue eliminada exitosamente.`})},error:i=>{this.messageService.add({severity:"error",summary:"Error al eliminar",detail:`No se pudo eliminar la tarea "${e.title}". Intenta nuevamente.`})}})}static{this.\u0275fac=function(i){return new(i||r)(l(S),l(T),l(U),l(re),l($))}}static{this.\u0275cmp=g({type:r,selectors:[["app-task-list"]],viewQuery:function(i,t){if(i&1&&D(Me,5),i&2){let a;j(a=w())&&(t.table=a.first)}},decls:5,vars:9,consts:[["dt",""],[1,"p-datatable-sm",3,"value","paginator","rows","responsiveLayout","showCurrentPageReport","filterDelay","globalFilterFields","sortMode"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex","justify-content-between","align-items-center","mb-2"],[1,"m-0"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar: ",1,"w-full","sm:w-auto",3,"input"],["pSortableColumn","title"],["field","title"],["pSortableColumn","description"],["field","description"],["pSortableColumn","status"],["pSortableColumn","createdAt"],["field","createdAt"],[1,"flex","align-items-center","gap-2"],["type","checkbox",1,"p-checkbox-box",3,"click","checked"],[3,"value","severity"],["pButton","","type","button","icon","pi pi-pencil","pTooltip","Editar tarea","tooltipPosition","top",1,"p-button-text","p-button-sm",3,"click"],["pButton","","type","button","icon","pi pi-trash","pTooltip","Eliminar tarea","tooltipPosition","top",1,"p-button-text","p-button-sm","p-button-danger",3,"click"]],template:function(i,t){i&1&&(o(0,"p-table",1,0),h(2,Ne,6,0,"ng-template",2)(3,Ve,16,0,"ng-template",3)(4,qe,17,10,"ng-template",4),n()),i&2&&p("value",t.tasks)("paginator",!0)("rows",10)("responsiveLayout","scroll")("showCurrentPageReport",!0)("filterDelay",500)("globalFilterFields",ee(8,Be))("sortMode","multiple")},dependencies:[v,de,b,fe,ke,Te,be,ve,ne]})}}return r})();var Ee=(()=>{class r{constructor(e,i,t,a){this.router=e,this.dialogService=i,this.sessionService=t,this.confirmationService=a}ngOnInit(){this.currentUserEmail=this.sessionService.getEmail()}confirmLogout(){this.confirmationService.confirm({key:"confirmationDialog",message:"\xBFEst\xE1s seguro(a) de que quieres cerrar sesi\xF3n?",header:"Confirmaci\xF3n",icon:"pi pi-exclamation-triangle",acceptLabel:"Si",rejectLabel:"No",acceptButtonStyleClass:"p-button-sucess p-button-text",rejectButtonStyleClass:"p-button-danger p-button-text",acceptIcon:"pi pi-check mr-2",rejectIcon:"pi pi-times mr-2",defaultFocus:"none",accept:()=>{this.logout()}})}createTask(){this.dialogService.open(_e,{header:"Crear tarea",width:"500px",modal:!0}).onClose.subscribe(i=>{i&&this.taskListComponent&&this.taskListComponent.loadTasks()})}logout(){localStorage.clear(),this.router.navigate(["/login"])}static{this.\u0275fac=function(i){return new(i||r)(l(se),l(U),l(le),l($))}}static{this.\u0275cmp=g({type:r,selectors:[["app-tasks"]],viewQuery:function(i,t){if(i&1&&D(P,5),i&2){let a;j(a=w())&&(t.taskListComponent=a.first)}},decls:10,vars:1,consts:[["key","confirmationDialog"],[1,"flex","flex-wrap","justify-content-between","align-items-center","gap-3","px-4","py-2","border-bottom","surface-100"],[1,"text-sm","text-primary","font-medium","flex","align-items-center","gap-2"],[1,"pi","pi-user"],[1,"flex","align-items-center","gap-2"],["pButton","","label","Crear tarea","icon","pi pi-plus",1,"p-button-sm","p-button-primary",3,"click"],["pButton","","label","Cerrar sesi\xF3n","icon","pi pi-sign-out",1,"p-button-sm","p-button-text","p-button-danger",3,"click"]],template:function(i,t){i&1&&(m(0,"p-confirmDialog",0)(1,"p-toast"),o(2,"div",1)(3,"span",2),m(4,"i",3),s(5),n(),o(6,"div",4)(7,"button",5),d("click",function(){return t.createTask()}),n(),o(8,"button",6),d("click",function(){return t.confirmLogout()}),n()()(),m(9,"app-task-list")),i&2&&(c(5),Z(" ",t.currentUserEmail," "))},dependencies:[v,he,ue,P]})}}return r})();var Ge=[{path:"",component:Ee}],Ie=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=F({type:r})}static{this.\u0275inj=I({imports:[z.forChild(Ge),z]})}}return r})();var kt=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=F({type:r})}static{this.\u0275inj=I({imports:[oe,me,ce,Ie,Ce]})}}return r})();export{kt as TasksModule};
